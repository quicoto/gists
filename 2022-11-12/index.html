<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>PHP Image Gallery | Ricard's code gists</title><style>:root{--primary:#0fd78c;--body-background:#162c35}::selection{background:#fdbb2d;color:var(--body-background)}html{font:20px/1.6 sans-serif;background:linear-gradient(45deg,#22c1c3 0%,#fdbb2d 100%);margin:0;background-attachment:fixed;padding:0 1rem 1rem}body{font-family:system-ui,-apple-system,segoe ui,Roboto,helvetica neue,noto sans,liberation sans,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;font-size:1rem;font-weight:300;line-height:1.5em;margin:1rem auto;max-width:70ch}main{background:var(--body-background);color:#fff;padding:1rem}.main-navigation{display:flex;justify-content:space-between}.main-navigation ul{display:flex;font-weight:400;gap:1rem;justify-content:end;list-style-type:none;margin:0 0 1rem;padding:0}.main-navigation a{color:var(--body-background)}a{color:var(--primary);text-decoration:none}a:hover{text-decoration:underline}h1{font-weight:400;line-height:1em}.site-title{font-weight:400;text-align:center;font-size:1.5rem;margin:0 0 1rem}p{margin:0 0 1rem}pre{margin-bottom:1rem}pre code{color:var(--body-background);display:block;border:none;padding:1em;background:0 0;overflow-x:auto}code{background:var(--primary);padding:0 .2em;font-family:courier new,Courier,monospace}time{display:inline-block;min-width:110px}.tag-list{display:flex;list-style-type:none;gap:.5rem;margin:0;padding:0}.tag-list a{border:1px solid;padding:.3em .5em}.tag-list a:hover{background:var(--primary);color:var(--body-background);text-decoration:none}.edit-github{text-align:right;margin-bottom:1rem}</style></head><body class=gists><nav id=site-navigation class=main-navigation><ul><li><a href=https://ricard.dev/gists/tags/ title=Tags>#Tags</a></li></ul><ul id=menu-top class=menu><li><a href=https://ricard.blog/ title="Ricard Torres Blog">Blog</a></li><li><a href=https://ricard.dev/ title="Ricard Torres dev">Dev</a></li><li><a href=https://ricard.social/ title=@ricard@ricard.social>Fediverse</a></li></ul></nav><main><header><p class=site-title><a href=https://ricard.dev/gists/>Ricard's code gists</a></p><hr><h1>PHP Image Gallery</h1></header><article><p>Uses PHP to create an image gallery with the given file and folder structure. No need for metadata or database, just reads the disk and builds the gallery</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;?</span>php
</span></span><span style=display:flex><span><span style=color:#d14>/**
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>General
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>- Requirements: php 7
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>Settings
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>- RANDOMIZE (default: true) // Order in main view
</span></span></span><span style=display:flex><span><span style=color:#d14>- ALBUMS (default: uploads) // Path to the folder
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>Content structure
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>- index.php (this file, or any other file name)
</span></span></span><span style=display:flex><span><span style=color:#d14>The galleries are regular folders with images files:
</span></span></span><span style=display:flex><span><span style=color:#d14>&#34;./uploads/folder_name/image.jpg&#34;
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>CSS
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>Bootstrap v5.0.0-beta2 or higher.
</span></span></span><span style=display:flex><span><span style=color:#d14>https://getbootstrap.com/
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>MIT License
</span></span></span><span style=display:flex><span><span style=color:#d14>======================================
</span></span></span><span style=display:flex><span><span style=color:#d14>Permission is hereby granted, free of charge, to any person obtaining a copy
</span></span></span><span style=display:flex><span><span style=color:#d14>of this software and associated documentation files (the &#34;Software&#34;), to deal
</span></span></span><span style=display:flex><span><span style=color:#d14>in the Software without restriction, including without limitation the rights
</span></span></span><span style=display:flex><span><span style=color:#d14>to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
</span></span></span><span style=display:flex><span><span style=color:#d14>copies of the Software, and to permit persons to whom the Software is
</span></span></span><span style=display:flex><span><span style=color:#d14>furnished to do so, subject to the following conditions:
</span></span></span><span style=display:flex><span><span style=color:#d14>The above copyright notice and this permission notice shall be included in all
</span></span></span><span style=display:flex><span><span style=color:#d14>copies or substantial portions of the Software.
</span></span></span><span style=display:flex><span><span style=color:#d14>THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
</span></span></span><span style=display:flex><span><span style=color:#d14>IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
</span></span></span><span style=display:flex><span><span style=color:#d14>FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
</span></span></span><span style=display:flex><span><span style=color:#d14>AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
</span></span></span><span style=display:flex><span><span style=color:#d14>LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
</span></span></span><span style=display:flex><span><span style=color:#d14>OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
</span></span></span><span style=display:flex><span><span style=color:#d14>SOFTWARE.
</span></span></span><span style=display:flex><span><span style=color:#d14>*/</span>
</span></span><span style=display:flex><span><span style=color:#999;font-weight:700;font-style:italic>?&gt;</span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;!DOCTYPE html&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;head&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;title&gt;Gallery&lt;/title&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;link rel=&#34;stylesheet&#34; href=&#34;bootstrap.min.css&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;/head&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;main&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>    &lt;header&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;div class=&#34;navbar navbar-dark bg-dark shadow-sm&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;div class=&#34;container&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          &lt;div class=&#34;navbar-brand d-flex align-items-center&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            &lt;a href=&#34;?&#34; class=&#34;text-white text-decoration-none&#34;&gt;&lt;strong&gt;Gallery&lt;/strong&gt;&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>    &lt;/header&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>    &lt;section class=&#34;container pt-2&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;div class=&#34;row&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;?php
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          define(&#39;RANDOMIZE&#39;, true);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          define(&#39;ALBUMS&#39;, &#39;uploads&#39;);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $extensions = &#34;jpg,jpeg,png,webp&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $isAlbum = isset($_GET[&#34;album&#34;]) ? true : false;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          function getFilePath($fileName) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            return ALBUMS . &#34;/&#34; . $_GET[&#34;album&#34;]. &#34;/&#34; . $fileName;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $folder = ALBUMS;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          if ($isAlbum) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            $folder = $folder . &#34;/&#34; . $_GET[&#34;album&#34;];
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          // Create recursive dir iterator which skips dot folders
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $dir = new RecursiveDirectoryIterator($folder,
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          FilesystemIterator::SKIP_DOTS);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          // Flatten the recursive iterator, folders come before their files
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $it  = new RecursiveIteratorIterator($dir,
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          RecursiveIteratorIterator::SELF_FIRST);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          // Maximum depth is 1 level deeper than the base folder
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $it-&gt;setMaxDepth(1);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $images = [];
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          $albums = [];
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          // Basic loop displaying different messages based on file or folder
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          if ($isAlbum) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            foreach ($it as $fileinfo) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              if ($fileinfo-&gt;isFile()) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>                array_push($images, getFilePath($it-&gt;getFilename()));
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          } else {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            foreach ($it as $fileinfo) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              if ($fileinfo-&gt;isDir()) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>                array_push($albums, $fileinfo-&gt;getFilename());
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          if ($isAlbum) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            natsort($images);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            foreach ($images as $image) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              echo &#34;&lt;div&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              echo &#34;&lt;img class=&#39;img-fluid img-thumbnail mb-2 mx-auto d-block&#39; src=&#39;&#34; . $image . &#34;&#39; alt=&#39;&#34; . $image . &#34;&#39; /&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              echo &#34;&lt;/div&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          } else {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            // List all directories
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            if (RANDOMIZE) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              shuffle($albums);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            } else {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              sort($albums);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            foreach ($albums as $key =&gt; $album) {
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              $files = glob(&#34;./&#34; . ALBUMS . &#34;/&#34; . $album . &#34;/*.{&#34; . $extensions . &#34;}&#34;, GLOB_BRACE);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              $featuredImageSrc = $files[shuffle($files)];
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              $image = &#34;&lt;img class=&#39;img-thumbnail mb-2&#39; src=&#39;&#34; . $featuredImageSrc . &#34;&#39;&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              $content = $image . &#34;&lt;small&gt;&#34;.$album.&#34;&lt;/small&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              echo &#34;&lt;div class=&#39;col-6 col-sm-4 col-lg-2 mb-4&#39;&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              printf(&#34;&lt;a href=&#39;?album=%s&#39;&gt;%s&lt;/a&gt;&#34;, $album, $content);
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>              echo &#34;&lt;/div&gt;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          }
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        ?&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>    &lt;/section&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>   &lt;footer class=&#34;container mt-4 mb-4&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;div class=&#34;row&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;div class=&#34;col-12&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          &lt;hr&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;div class=&#34;col d-grid gap-2&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          &lt;?php if ($isAlbum) { ?&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>            &lt;a href=&#34;?&#34; class=&#34;btn btn-primary btn-block&#34;&gt;Go back&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>          &lt;?php } ?&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>        &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>      &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>   &lt;/footer&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>  &lt;/main&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;/body&gt;
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>
</span></span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>&lt;/html&gt;
</span></span></span></code></pre></div><aside class=edit-github><a target=_blank href=https://github.com/quicoto/gists/blob/main/content/writing/2022-11-12.md>View on GitHub</a></aside></article><footer><ul class=tag-list><li><a href=https://ricard.dev/gists/tags/php/># php</a></li></ul></footer></main></body></html>